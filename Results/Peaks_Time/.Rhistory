peaksLA <- findpeaks( vecLA, minpeakheight = val* (max(vecLA) - min(vecLA)) )
# Plot Cell
xc <- matrix( theta1_X[tind[i], ])
yc <- matrix( theta1_Y[tind[i], ])
CellTitle = paste("Cell contour Time", c(tind[i]))
plot(x=xc, y=yc, type="l", xlab = "x coordinate", ylab="y coordinate", main = CellTitle )
points ( xc[peaksLA[,2]], yc[peaksLA[,2]], pch=1, lwd=2, col="#41b6c4")
points ( xc[peaksLI[,2]], yc[peaksLI[,2]], pch=20, col="#c51b8a")
grid()
# Plot LI
adj <- 0.1 * max(vecLI)
plot( vecLI , type = "l", ylab = "LI", main= "LI", col="navy", xlab="Node number")
grid()
points (peaksLI[,2], peaksLI[,1], pch = 20, col="#c51b8a")
text (peaksLI[,2], peaksLI[,1]+adj, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
abline( h= val* (max(vecLI) - min(vecLI)) )
# Plot LA
adj <- 0.1 * max(vecLA)
plot( vecLA , type = "l", ylab = "LA", main= "LA", col="navy", xlab="Node number")
grid()
points (peaksLA[,2], peaksLA[,1], pch = 1, col="#41b6c4")
text (peaksLA[,2], peaksLA[,1]+adj, pch= paste( c(1:nrow(peaksLA))),  col="#41b6c4")
abline( h= val* (max(vecLA) - min(vecLA)), col = "gray" )
mtext( paste( "Theta", j , ": Peak location of LI and LA on cell membrane", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
}
par( mfrow = c(4,3), mar = c(4,4,2,0.5), oma = c(0, 0, 3, 0))
val <- 0.15
for (i in 1:4){
## get index of positions without NAs
theta1_indLI <- ! is.na( theta1_LI [tind[i], ])
theta1_indLA <- ! is.na( theta1_LA [tind[i], ])
vecLI <- as.numeric (matrix ( theta1_LI[tind[i], theta1_indLI ]))
vecLA <- as.numeric (matrix ( theta1_LA[tind[i], theta1_indLA ]))
# where the peaks of LI are, col 1 = LI value, col2 = node location
# peaksLI <- findpeaks( vecLI, threshold = 1.1 * min(vecLI), ndowns=5, nups=5 )
# peaksLA <- findpeaks( vecLA, threshold = 1.1 * min(vecLA), ndowns=5, nups=5 )
# peaksLI <- findpeaks( vecLI )
# peaksLA <- findpeaks( vecLA )
peaksLI <- findpeaks( vecLI, minpeakheight = val* (max(vecLI) - min(vecLI)) )
peaksLA <- findpeaks( vecLA, minpeakheight = val* (max(vecLA) - min(vecLA)) )
# Plot Cell
xc <- matrix( theta1_X[tind[i], ])
yc <- matrix( theta1_Y[tind[i], ])
CellTitle = paste("Cell contour Time", c(tind[i]))
plot(x=xc, y=yc, type="l", xlab = "x coordinate", ylab="y coordinate", main = CellTitle )
points ( xc[peaksLA[,2]], yc[peaksLA[,2]], pch=1, lwd=2, col="#41b6c4")
points ( xc[peaksLI[,2]], yc[peaksLI[,2]], pch=20, col="#c51b8a")
grid()
# Plot LI
adj <- 0.1 * max(vecLI)
plot( vecLI , type = "l", ylab = "LI", main= "LI", col="navy", xlab="Node number")
grid()
points (peaksLI[,2], peaksLI[,1], pch = 20, col="#c51b8a")
text (peaksLI[,2], peaksLI[,1]+adj, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
abline( h= val* (max(vecLI) - min(vecLI)) )
# Plot LA
adj <- 0.1 * max(vecLA)
plot( vecLA , type = "l", ylab = "LA", main= "LA", col="navy", xlab="Node number")
grid()
points (peaksLA[,2], peaksLA[,1], pch = 1, col="#41b6c4")
text (peaksLA[,2], peaksLA[,1]+adj, pch= paste( c(1:nrow(peaksLA))),  col="#41b6c4")
abline( h= val* (max(vecLA) - min(vecLA)), col = "gray" )
mtext( paste( "Theta", j , ": Peak location of LI and LA on cell membrane", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
}
par( mfrow = c(4,3), mar = c(4,4,2,0.5), oma = c(0, 0, 3, 0))
val <- 0.15
for (i in 1:4){
## get index of positions without NAs
theta1_indLI <- ! is.na( theta1_LI [tind[i], ])
theta1_indLA <- ! is.na( theta1_LA [tind[i], ])
vecLI <- as.numeric (matrix ( theta1_LI[tind[i], theta1_indLI ]))
vecLA <- as.numeric (matrix ( theta1_LA[tind[i], theta1_indLA ]))
# where the peaks of LI are, col 1 = LI value, col2 = node location
# peaksLI <- findpeaks( vecLI, threshold = 1.1 * min(vecLI), ndowns=5, nups=5 )
# peaksLA <- findpeaks( vecLA, threshold = 1.1 * min(vecLA), ndowns=5, nups=5 )
# peaksLI <- findpeaks( vecLI )
# peaksLA <- findpeaks( vecLA )
peaksLI <- findpeaks( vecLI, minpeakheight = val* (max(vecLI) - min(vecLI)) )
peaksLA <- findpeaks( vecLA, minpeakheight = val* (max(vecLA) - min(vecLA)) )
# Plot Cell
xc <- matrix( theta1_X[tind[i], ])
yc <- matrix( theta1_Y[tind[i], ])
CellTitle = paste("Cell contour Time", c(tind[i]))
plot(x=xc, y=yc, type="l", xlab = "x coordinate", ylab="y coordinate", main = CellTitle )
points ( xc[peaksLA[,2]], yc[peaksLA[,2]], pch=1, lwd=2, col="#41b6c4")
points ( xc[peaksLI[,2]], yc[peaksLI[,2]], pch=20, col="#c51b8a")
grid()
# Plot LI
adj <- 0.1 * max(vecLI)
plot( vecLI , type = "l", ylab = "LI", main= "LI", col="navy", xlab="Node number")
grid()
points (peaksLI[,2], peaksLI[,1], pch = 20, col="#c51b8a")
text (peaksLI[,2], peaksLI[,1]+adj, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
abline( h= val* (max(vecLI) - min(vecLI)), col = "gray" )
# Plot LA
adj <- 0.1 * max(vecLA)
plot( vecLA , type = "l", ylab = "LA", main= "LA", col="navy", xlab="Node number")
grid()
points (peaksLA[,2], peaksLA[,1], pch = 1, col="#41b6c4")
text (peaksLA[,2], peaksLA[,1]+adj, pch= paste( c(1:nrow(peaksLA))),  col="#41b6c4")
abline( h= val* (max(vecLA) - min(vecLA)), col = "gray" )
mtext( paste( "Theta", j , ": Peak location of LI and LA on cell membrane", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
}
points ( xc[peaksLI[,2]], yc[peaksLI[,2]], pch=20, col="#c51b8a")
text (peaksLI[,2]+adj, peaksLI[,1]+adj, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
CellTitle = paste("Cell contour Time", c(tind[i]))
plot(x=xc, y=yc, type="l", xlab = "x coordinate", ylab="y coordinate", main = CellTitle )
points ( xc[peaksLA[,2]], yc[peaksLA[,2]], pch=1, lwd=2, col="#41b6c4")
points ( xc[peaksLI[,2]], yc[peaksLI[,2]], pch=20, col="#c51b8a")
text (peaksLI[,2]+adj, peaksLI[,1]+adj, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
grid()
adjLI <- 0.1 * max(vecLI)
adjLA <- 0.1 * max(vecLA)
# Plot Cell
xc <- matrix( theta1_X[tind[i], ])
yc <- matrix( theta1_Y[tind[i], ])
CellTitle = paste("Cell contour Time", c(tind[i]))
plot(x=xc, y=yc, type="l", xlab = "x coordinate", ylab="y coordinate", main = CellTitle )
points ( xc[peaksLA[,2]], yc[peaksLA[,2]], pch=1, lwd=2, col="#41b6c4")
points ( xc[peaksLI[,2]], yc[peaksLI[,2]], pch=20, col="#c51b8a")
text (peaksLI[,2]+adjLI, peaksLI[,1]+adjLA, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
grid()
# Plot LI
plot( vecLI , type = "l", ylab = "LI", main= "LI", col="navy", xlab="Node number")
grid()
points (peaksLI[,2], peaksLI[,1], pch = 20, col="#c51b8a")
text (peaksLI[,2], peaksLI[,1]+adjLI, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
abline( h= val* (max(vecLI) - min(vecLI)), col = "gray" )
# Plot LA
plot( vecLA , type = "l", ylab = "LA", main= "LA", col="navy", xlab="Node number")
grid()
points (peaksLA[,2], peaksLA[,1], pch = 1, col="#41b6c4")
text (peaksLA[,2], peaksLA[,1]+adjLA, pch= paste( c(1:nrow(peaksLA))),  col="#41b6c4")
abline( h= val* (max(vecLA) - min(vecLA)), col = "gray" )
par( mfrow = c(4,3), mar = c(4,4,2,0.5), oma = c(0, 0, 3, 0))
val <- 0.15
for (i in 1:4){
## get index of positions without NAs
theta1_indLI <- ! is.na( theta1_LI [tind[i], ])
theta1_indLA <- ! is.na( theta1_LA [tind[i], ])
vecLI <- as.numeric (matrix ( theta1_LI[tind[i], theta1_indLI ]))
vecLA <- as.numeric (matrix ( theta1_LA[tind[i], theta1_indLA ]))
# where the peaks of LI are, col 1 = LI value, col2 = node location
# peaksLI <- findpeaks( vecLI, threshold = 1.1 * min(vecLI), ndowns=5, nups=5 )
# peaksLA <- findpeaks( vecLA, threshold = 1.1 * min(vecLA), ndowns=5, nups=5 )
# peaksLI <- findpeaks( vecLI )
# peaksLA <- findpeaks( vecLA )
peaksLI <- findpeaks( vecLI, minpeakheight = val* (max(vecLI) - min(vecLI)) )
peaksLA <- findpeaks( vecLA, minpeakheight = val* (max(vecLA) - min(vecLA)) )
adjLI <- 0.1 * max(vecLI)
adjLA <- 0.1 * max(vecLA)
# Plot Cell
xc <- matrix( theta1_X[tind[i], ])
yc <- matrix( theta1_Y[tind[i], ])
CellTitle = paste("Cell contour Time", c(tind[i]))
plot(x=xc, y=yc, type="l", xlab = "x coordinate", ylab="y coordinate", main = CellTitle )
points ( xc[peaksLA[,2]], yc[peaksLA[,2]], pch=1, lwd=2, col="#41b6c4")
points ( xc[peaksLI[,2]], yc[peaksLI[,2]], pch=20, col="#c51b8a")
text (peaksLI[,2]+adjLI, peaksLI[,1]+adjLA, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
grid()
# Plot LI
plot( vecLI , type = "l", ylab = "LI", main= "LI", col="navy", xlab="Node number")
grid()
points (peaksLI[,2], peaksLI[,1], pch = 20, col="#c51b8a")
text (peaksLI[,2], peaksLI[,1]+adjLI, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
abline( h= val* (max(vecLI) - min(vecLI)), col = "gray" )
# Plot LA
plot( vecLA , type = "l", ylab = "LA", main= "LA", col="navy", xlab="Node number")
grid()
points (peaksLA[,2], peaksLA[,1], pch = 1, col="#41b6c4")
text (peaksLA[,2], peaksLA[,1]+adjLA, pch= paste( c(1:nrow(peaksLA))),  col="#41b6c4")
abline( h= val* (max(vecLA) - min(vecLA)), col = "gray" )
mtext( paste( "Theta", j , ": Peak location of LI and LA on cell membrane", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
}
j<-50
pdf( paste("Theta", j, ".pdf", sep=""))
# Plotting settings for LI/LA peaks plots
par( mfrow = c(4,3), mar = c(4,4,2,0.5), oma = c(0, 0, 3, 0))
val <- 0.15
for (i in 1:4){
## get index of positions without NAs
theta1_indLI <- ! is.na( theta1_LI [tind[i], ])
theta1_indLA <- ! is.na( theta1_LA [tind[i], ])
vecLI <- as.numeric (matrix ( theta1_LI[tind[i], theta1_indLI ]))
vecLA <- as.numeric (matrix ( theta1_LA[tind[i], theta1_indLA ]))
# where the peaks of LI are, col 1 = LI value, col2 = node location
# peaksLI <- findpeaks( vecLI, threshold = 1.1 * min(vecLI), ndowns=5, nups=5 )
# peaksLA <- findpeaks( vecLA, threshold = 1.1 * min(vecLA), ndowns=5, nups=5 )
peaksLI <- findpeaks( vecLI )
peaksLA <- findpeaks( vecLA )
# peaksLI <- findpeaks( vecLI, minpeakheight = val* (max(vecLI) - min(vecLI)) )
# peaksLA <- findpeaks( vecLA, minpeakheight = val* (max(vecLA) - min(vecLA)) )
#
adjLI <- 0.1 * max(vecLI)
adjLA <- 0.1 * max(vecLA)
# Plot Cell
xc <- matrix( theta1_X[tind[i], ])
yc <- matrix( theta1_Y[tind[i], ])
CellTitle = paste("Cell contour Time", c(tind[i]))
plot(x=xc, y=yc, type="l", xlab = "x coordinate", ylab="y coordinate", main = CellTitle )
points ( xc[peaksLA[,2]], yc[peaksLA[,2]], pch=1, lwd=2, col="#41b6c4")
points ( xc[peaksLI[,2]], yc[peaksLI[,2]], pch=20, col="#c51b8a")
text (peaksLI[,2]+adjLI, peaksLI[,1]+adjLA, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
grid()
# Plot LI
plot( vecLI , type = "l", ylab = "LI", main= "LI", col="navy", xlab="Node number")
grid()
points (peaksLI[,2], peaksLI[,1], pch = 20, col="#c51b8a")
text (peaksLI[,2], peaksLI[,1]+adjLI, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
abline( h= val* (max(vecLI) - min(vecLI)), col = "gray" )
# Plot LA
plot( vecLA , type = "l", ylab = "LA", main= "LA", col="navy", xlab="Node number")
grid()
points (peaksLA[,2], peaksLA[,1], pch = 1, col="#41b6c4")
text (peaksLA[,2], peaksLA[,1]+adjLA, pch= paste( c(1:nrow(peaksLA))),  col="#41b6c4")
abline( h= val* (max(vecLA) - min(vecLA)), col = "gray" )
mtext( paste( "Theta", j , ": Peak location of LI and LA on cell membrane", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
}
dev.off()
# Read in data
theta1_LI <- PseudoRead( Path = path, Output = "LI" )
theta1_LA <- PseudoRead( Path = path, Output = "LA" )
theta1_X <- PseudoRead( Path = path, Output = "X" )
theta1_Y <- PseudoRead( Path = path, Output = "Y" )
j<-50
pdf( paste("Theta", j, ".pdf", sep=""))
# Plotting settings for LI/LA peaks plots
par( mfrow = c(4,3), mar = c(4,4,2,0.5), oma = c(0, 0, 3, 0))
val <- 0.15
for (i in 1:4){
## get index of positions without NAs
theta1_indLI <- ! is.na( theta1_LI [tind[i], ])
theta1_indLA <- ! is.na( theta1_LA [tind[i], ])
vecLI <- as.numeric (matrix ( theta1_LI[tind[i], theta1_indLI ]))
vecLA <- as.numeric (matrix ( theta1_LA[tind[i], theta1_indLA ]))
# where the peaks of LI are, col 1 = LI value, col2 = node location
# peaksLI <- findpeaks( vecLI, threshold = 1.1 * min(vecLI), ndowns=5, nups=5 )
# peaksLA <- findpeaks( vecLA, threshold = 1.1 * min(vecLA), ndowns=5, nups=5 )
peaksLI <- findpeaks( vecLI )
peaksLA <- findpeaks( vecLA )
# peaksLI <- findpeaks( vecLI, minpeakheight = val* (max(vecLI) - min(vecLI)) )
# peaksLA <- findpeaks( vecLA, minpeakheight = val* (max(vecLA) - min(vecLA)) )
#
adjLI <- 0.1 * max(vecLI)
adjLA <- 0.1 * max(vecLA)
# Plot Cell
xc <- matrix( theta1_X[tind[i], ])
yc <- matrix( theta1_Y[tind[i], ])
CellTitle = paste("Cell contour Time", c(tind[i]))
plot(x=xc, y=yc, type="l", xlab = "x coordinate", ylab="y coordinate", main = CellTitle )
points ( xc[peaksLA[,2]], yc[peaksLA[,2]], pch=1, lwd=2, col="#41b6c4")
points ( xc[peaksLI[,2]], yc[peaksLI[,2]], pch=20, col="#c51b8a")
text (peaksLI[,2]+adjLI, peaksLI[,1]+adjLA, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
grid()
# Plot LI
plot( vecLI , type = "l", ylab = "LI", main= "LI", col="navy", xlab="Node number")
grid()
points (peaksLI[,2], peaksLI[,1], pch = 20, col="#c51b8a")
text (peaksLI[,2], peaksLI[,1]+adjLI, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
#abline( h= val* (max(vecLI) - min(vecLI)), col = "gray" )
# Plot LA
plot( vecLA , type = "l", ylab = "LA", main= "LA", col="navy", xlab="Node number")
grid()
points (peaksLA[,2], peaksLA[,1], pch = 1, col="#41b6c4")
text (peaksLA[,2], peaksLA[,1]+adjLA, pch= paste( c(1:nrow(peaksLA))),  col="#41b6c4")
#abline( h= val* (max(vecLA) - min(vecLA)), col = "gray" )
mtext( paste( "Theta", j , ": Peak location of LI and LA on cell membrane", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
}
dev.off()
npeakLA <- nrow( peaksLA > val* (max(vecLA) - min(vecLA)))
npeakLA
peaksLA
for (i in 1:4){
## get index of positions without NAs
theta1_indLI <- ! is.na( theta1_LI [tind[i], ])
theta1_indLA <- ! is.na( theta1_LA [tind[i], ])
vecLI <- as.numeric (matrix ( theta1_LI[tind[i], theta1_indLI ]))
vecLA <- as.numeric (matrix ( theta1_LA[tind[i], theta1_indLA ]))
# where the peaks of LI are, col 1 = LI value, col2 = node location
# peaksLI <- findpeaks( vecLI, threshold = 1.1 * min(vecLI), ndowns=5, nups=5 )
# peaksLA <- findpeaks( vecLA, threshold = 1.1 * min(vecLA), ndowns=5, nups=5 )
peaksLI <- findpeaks( vecLI )
peaksLA <- findpeaks( vecLA )
# peaksLI <- findpeaks( vecLI, minpeakheight = val* (max(vecLI) - min(vecLI)) )
# peaksLA <- findpeaks( vecLA, minpeakheight = val* (max(vecLA) - min(vecLA)) )
#
adjLI <- 0.1 * max(vecLI)
adjLA <- 0.1 * max(vecLA)
# Plot Cell
xc <- matrix( theta1_X[tind[i], ])
yc <- matrix( theta1_Y[tind[i], ])
CellTitle = paste("Cell contour Time", c(tind[i]))
plot(x=xc, y=yc, type="l", xlab = "x coordinate", ylab="y coordinate", main = CellTitle )
points ( xc[peaksLA[,2]], yc[peaksLA[,2]], pch=1, lwd=2, col="#41b6c4")
points ( xc[peaksLI[,2]], yc[peaksLI[,2]], pch=20, col="#c51b8a")
text (peaksLI[,2]+adjLI, peaksLI[,1]+adjLA, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
grid()
# Plot LI
plot( vecLI , type = "l", ylab = "LI", main= "LI", col="navy", xlab="Node number")
grid()
points (peaksLI[,2], peaksLI[,1], pch = 20, col="#c51b8a")
text (peaksLI[,2], peaksLI[,1]+adjLI, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
#abline( h= val* (max(vecLI) - min(vecLI)), col = "gray" )
# Plot LA
plot( vecLA , type = "l", ylab = "LA", main= "LA", col="navy", xlab="Node number")
grid()
points (peaksLA[,2], peaksLA[,1], pch = 1, col="#41b6c4")
text (peaksLA[,2], peaksLA[,1]+adjLA, pch= paste( c(1:nrow(peaksLA))),  col="#41b6c4")
#abline( h= val* (max(vecLA) - min(vecLA)), col = "gray" )
mtext( paste( "Theta", j , ": Peak location of LI and LA on cell membrane", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
npeakLA[i] <- nrow( peaksLA > val* (max(vecLA) - min(vecLA)))
npeakLI[i] <- nrow( peaksLI > val* (max(vecLI) - min(vecLI)))
}
npeakLI <- numeric(4)
npeakLA <- numeric(4)
for (i in 1:4){
## get index of positions without NAs
theta1_indLI <- ! is.na( theta1_LI [tind[i], ])
theta1_indLA <- ! is.na( theta1_LA [tind[i], ])
vecLI <- as.numeric (matrix ( theta1_LI[tind[i], theta1_indLI ]))
vecLA <- as.numeric (matrix ( theta1_LA[tind[i], theta1_indLA ]))
# where the peaks of LI are, col 1 = LI value, col2 = node location
# peaksLI <- findpeaks( vecLI, threshold = 1.1 * min(vecLI), ndowns=5, nups=5 )
# peaksLA <- findpeaks( vecLA, threshold = 1.1 * min(vecLA), ndowns=5, nups=5 )
peaksLI <- findpeaks( vecLI )
peaksLA <- findpeaks( vecLA )
# peaksLI <- findpeaks( vecLI, minpeakheight = val* (max(vecLI) - min(vecLI)) )
# peaksLA <- findpeaks( vecLA, minpeakheight = val* (max(vecLA) - min(vecLA)) )
#
adjLI <- 0.1 * max(vecLI)
adjLA <- 0.1 * max(vecLA)
# Plot Cell
xc <- matrix( theta1_X[tind[i], ])
yc <- matrix( theta1_Y[tind[i], ])
CellTitle = paste("Cell contour Time", c(tind[i]))
plot(x=xc, y=yc, type="l", xlab = "x coordinate", ylab="y coordinate", main = CellTitle )
points ( xc[peaksLA[,2]], yc[peaksLA[,2]], pch=1, lwd=2, col="#41b6c4")
points ( xc[peaksLI[,2]], yc[peaksLI[,2]], pch=20, col="#c51b8a")
text (peaksLI[,2]+adjLI, peaksLI[,1]+adjLA, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
grid()
# Plot LI
plot( vecLI , type = "l", ylab = "LI", main= "LI", col="navy", xlab="Node number")
grid()
points (peaksLI[,2], peaksLI[,1], pch = 20, col="#c51b8a")
text (peaksLI[,2], peaksLI[,1]+adjLI, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
#abline( h= val* (max(vecLI) - min(vecLI)), col = "gray" )
# Plot LA
plot( vecLA , type = "l", ylab = "LA", main= "LA", col="navy", xlab="Node number")
grid()
points (peaksLA[,2], peaksLA[,1], pch = 1, col="#41b6c4")
text (peaksLA[,2], peaksLA[,1]+adjLA, pch= paste( c(1:nrow(peaksLA))),  col="#41b6c4")
#abline( h= val* (max(vecLA) - min(vecLA)), col = "gray" )
mtext( paste( "Theta", j , ": Peak location of LI and LA on cell membrane", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
npeakLA[i] <- nrow( peaksLA > val* (max(vecLA) - min(vecLA)))
npeakLI[i] <- nrow( peaksLI > val* (max(vecLI) - min(vecLI)))
}
plot(npeakLA, type='l')
plot(npeakLI, type='l')
plot(npeakLA, tind,  type='b')
plot(npeakLI, tind,  type='b')
plot(npeakLA, x=tind,  type='b')
plot(npeakLI, x=tind,  type='b')
plot(npeakLA, x=tind,  type='b', main = paste ( "Theta", j, " number of peaks LA"))
plot(npeakLI, x=tind,  type='b', main = paste ( "Theta", j, " number of peaks LI"))
plot(npeakLA, x=tind,  type='b', main = paste ( "Theta", j, " number of peaks LA"), ylab = "Time")
plot(npeakLI, x=tind,  type='b', main = paste ( "Theta", j, " number of peaks LI"), ylab = "Time")
par(mfrow = c(2,1))
plot(npeakLA, x=tind,  type='b', main = paste ( "Theta", j, " number of peaks LA"), ylab = "Time")
plot(npeakLI, x=tind,  type='b', main = paste ( "Theta", j, " number of peaks LI"), ylab = "Time")
par(mfrow = c(1,2))
plot(npeakLA, x=tind,  type='b', main = paste ( "Theta", j, " number of peaks LA"), ylab = "Time")
plot(npeakLI, x=tind,  type='b', main = paste ( "Theta", j, " number of peaks LI"), ylab = "Time")
plot(npeakLA, x=tind,  type='b', main = paste ( "Theta", j, " number of peaks LA"), ylab = "Time")
plot(y=npeakLI, x=tind,  type='b', main = paste ( "Theta", j, " number of peaks LI"), ylab = "Time")
plot(y=npeakLI, x=tind,  type='b', main = paste ( "Theta", j, " number of peaks LI"), xlab = "Time")
plot(y=npeakLA, x=tind,  type='b', main = paste ( "Theta", j, " number of peaks LA"), xlab = "Time", ylab = "Number of peaks")
plot(y=npeakLI, x=tind,  type='b', main = paste ( "Theta", j, " number of peaks LI"), xlab = "Time", ylab = "Number of peaks")
mtext( paste( "Theta", j , "number of peaks", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
mtext( paste( "Theta", j , " number of peaks", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
par(mfrow = c(1,2))
plot(y=npeakLA, x=tind,  type='b', main = paste ( "Theta", j, " number of peaks LA"), xlab = "Time", ylab = "Number of peaks")
plot(y=npeakLI, x=tind,  type='b', main = paste ( "Theta", j, " number of peaks LI"), xlab = "Time", ylab = "Number of peaks")
mtext( paste( "Theta", j , " number of peaks", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
par(mfrow = c(1,2))
plot(y=npeakLA, x=tind,  type='b', main =  "LA", xlab = "Time", ylab = "Number of peaks")
plot(y=npeakLI, x=tind,  type='b', main =  "LI", xlab = "Time", ylab = "Number of peaks")
mtext( paste( "Theta", j , " number of peaks", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
tind <- c( 100, 300, 500, 1000)
for ( j in 1:100) {
path <- paste("MS", j, sep="")
# Read in data
theta1_LI <- PseudoRead( Path = path, Output = "LI" )
theta1_LA <- PseudoRead( Path = path, Output = "LA" )
theta1_X <- PseudoRead( Path = path, Output = "X" )
theta1_Y <- PseudoRead( Path = path, Output = "Y" )
# pdf( paste("Theta", j, ".pdf", sep=""))
# Plotting settings for LI/LA peaks plots
par( mfrow = c(4,3), mar = c(4,4,2,0.5), oma = c(0, 0, 3, 0))
val <- 0.15
# Plot peak locations of LI and LA on cell membrane
for (i in 1:4){
## get index of positions without NAs
theta1_indLI <- ! is.na( theta1_LI [tind[i], ])
theta1_indLA <- ! is.na( theta1_LA [tind[i], ])
vecLI <- as.numeric (matrix ( theta1_LI[tind[i], theta1_indLI ]))
vecLA <- as.numeric (matrix ( theta1_LA[tind[i], theta1_indLA ]))
# where the peaks of LI are, col 1 = LI value, col2 = node location
# peaksLI <- findpeaks( vecLI, threshold = 1.1 * min(vecLI), ndowns=5, nups=5 )
# peaksLA <- findpeaks( vecLA, threshold = 1.1 * min(vecLA), ndowns=5, nups=5 )
peaksLI <- findpeaks( vecLI )
peaksLA <- findpeaks( vecLA )
# peaksLI <- findpeaks( vecLI, minpeakheight = val* (max(vecLI) - min(vecLI)) )
# peaksLA <- findpeaks( vecLA, minpeakheight = val* (max(vecLA) - min(vecLA)) )
#
adjLI <- 0.1 * max(vecLI)
adjLA <- 0.1 * max(vecLA)
# Plot Cell
xc <- matrix( theta1_X[tind[i], ])
yc <- matrix( theta1_Y[tind[i], ])
CellTitle = paste("Cell contour Time", c(tind[i]))
plot(x=xc, y=yc, type="l", xlab = "x coordinate", ylab="y coordinate", main = CellTitle )
points ( xc[peaksLA[,2]], yc[peaksLA[,2]], pch=1, lwd=2, col="#41b6c4")
points ( xc[peaksLI[,2]], yc[peaksLI[,2]], pch=20, col="#c51b8a")
text (peaksLI[,2]+adjLI, peaksLI[,1]+adjLA, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
grid()
# Plot LI
plot( vecLI , type = "l", ylab = "LI", main= "LI", col="navy", xlab="Node number")
grid()
points (peaksLI[,2], peaksLI[,1], pch = 20, col="#c51b8a")
text (peaksLI[,2], peaksLI[,1]+adjLI, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
#abline( h= val* (max(vecLI) - min(vecLI)), col = "gray" )
# Plot LA
plot( vecLA , type = "l", ylab = "LA", main= "LA", col="navy", xlab="Node number")
grid()
points (peaksLA[,2], peaksLA[,1], pch = 1, col="#41b6c4")
text (peaksLA[,2], peaksLA[,1]+adjLA, pch= paste( c(1:nrow(peaksLA))),  col="#41b6c4")
#abline( h= val* (max(vecLA) - min(vecLA)), col = "gray" )
mtext( paste( "Theta", j , ": Peak location of LI and LA on cell membrane", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
npeakLA[i] <- nrow( peaksLA > val* (max(vecLA) - min(vecLA)))
npeakLI[i] <- nrow( peaksLI > val* (max(vecLI) - min(vecLI)))
}
# dev.off()
pdf( paste("Theta", j, ".pdf", sep=""))
par(mfrow = c(1,2))
plot(y=npeakLA, x=tind,  type='b', main =  "LA", xlab = "Time", ylab = "Number of peaks")
plot(y=npeakLI, x=tind,  type='b', main =  "LI", xlab = "Time", ylab = "Number of peaks")
mtext( paste( "Theta", j , " number of peaks over time", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
dev.off()
}
setwd("~/Desktop/Pseudopod/Results/Peaks_Time")
tind <- c( 100, 300, 500, 1000)
for ( j in 1:100) {
path <- paste("MS", j, sep="")
# Read in data
theta1_LI <- PseudoRead( Path = path, Output = "LI" )
theta1_LA <- PseudoRead( Path = path, Output = "LA" )
theta1_X <- PseudoRead( Path = path, Output = "X" )
theta1_Y <- PseudoRead( Path = path, Output = "Y" )
# pdf( paste("Theta", j, ".pdf", sep=""))
# Plotting settings for LI/LA peaks plots
par( mfrow = c(4,3), mar = c(4,4,2,0.5), oma = c(0, 0, 3, 0))
val <- 0.15
# Plot peak locations of LI and LA on cell membrane
for (i in 1:4){
## get index of positions without NAs
theta1_indLI <- ! is.na( theta1_LI [tind[i], ])
theta1_indLA <- ! is.na( theta1_LA [tind[i], ])
vecLI <- as.numeric (matrix ( theta1_LI[tind[i], theta1_indLI ]))
vecLA <- as.numeric (matrix ( theta1_LA[tind[i], theta1_indLA ]))
# where the peaks of LI are, col 1 = LI value, col2 = node location
# peaksLI <- findpeaks( vecLI, threshold = 1.1 * min(vecLI), ndowns=5, nups=5 )
# peaksLA <- findpeaks( vecLA, threshold = 1.1 * min(vecLA), ndowns=5, nups=5 )
peaksLI <- findpeaks( vecLI )
peaksLA <- findpeaks( vecLA )
# peaksLI <- findpeaks( vecLI, minpeakheight = val* (max(vecLI) - min(vecLI)) )
# peaksLA <- findpeaks( vecLA, minpeakheight = val* (max(vecLA) - min(vecLA)) )
#
adjLI <- 0.1 * max(vecLI)
adjLA <- 0.1 * max(vecLA)
# Plot Cell
xc <- matrix( theta1_X[tind[i], ])
yc <- matrix( theta1_Y[tind[i], ])
CellTitle = paste("Cell contour Time", c(tind[i]))
plot(x=xc, y=yc, type="l", xlab = "x coordinate", ylab="y coordinate", main = CellTitle )
points ( xc[peaksLA[,2]], yc[peaksLA[,2]], pch=1, lwd=2, col="#41b6c4")
points ( xc[peaksLI[,2]], yc[peaksLI[,2]], pch=20, col="#c51b8a")
text (peaksLI[,2]+adjLI, peaksLI[,1]+adjLA, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
grid()
# Plot LI
plot( vecLI , type = "l", ylab = "LI", main= "LI", col="navy", xlab="Node number")
grid()
points (peaksLI[,2], peaksLI[,1], pch = 20, col="#c51b8a")
text (peaksLI[,2], peaksLI[,1]+adjLI, pch= paste( c(1:nrow(peaksLI))),  col="#c51b8a")
#abline( h= val* (max(vecLI) - min(vecLI)), col = "gray" )
# Plot LA
plot( vecLA , type = "l", ylab = "LA", main= "LA", col="navy", xlab="Node number")
grid()
points (peaksLA[,2], peaksLA[,1], pch = 1, col="#41b6c4")
text (peaksLA[,2], peaksLA[,1]+adjLA, pch= paste( c(1:nrow(peaksLA))),  col="#41b6c4")
#abline( h= val* (max(vecLA) - min(vecLA)), col = "gray" )
mtext( paste( "Theta", j , ": Peak location of LI and LA on cell membrane", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
npeakLA[i] <- nrow( peaksLA > val* (max(vecLA) - min(vecLA)))
npeakLI[i] <- nrow( peaksLI > val* (max(vecLI) - min(vecLI)))
}
# dev.off()
pdf( paste("Theta", j, ".pdf", sep=""))
par(mfrow = c(1,2))
plot(y=npeakLA, x=tind,  type='b', main =  "LA", xlab = "Time", ylab = "Number of peaks")
plot(y=npeakLI, x=tind,  type='b', main =  "LI", xlab = "Time", ylab = "Number of peaks")
mtext( paste( "Theta", j , " number of peaks over time", sep=""), outer = TRUE, side = 3, cex = 1.2, line = 1, adj = 0 )
dev.off()
}
